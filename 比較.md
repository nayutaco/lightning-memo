# コマンド

|                | c-lightning  | eclair | lnd           | ptarmigan     |
|----------------|--------------|--------|---------------|---------------|
| address        | newaddr      |        | newaddress    | pay_fundin.sh |
| balance        | listfunds    |        | walletbalance |               |
| connect        | connect      |        | connect       |               |
| open           | fundchannel  |        | openchannel   | -f            |
| create invoice | invoice      |        | addinvoice    | -i            |
| payment        | pay          |        | payinvoice    | -r/-R         |
| peer           | listpeers    |        | listpeers     |               |
| channel        | listchannels |        | listchannels  |               |

# デフォルト値

## c-lightning

* accept_channelで取得

```text
dust_limit_sat= 546
max_htlc_value_in_flight_msat= 18446744073709551615
channel_reserve_sat= 8000
min_depth= 1
htlc_minimum_msat= 0
to_self_delay= 6
max_accepted_htlcs= 483
```

```text
cltv_expiry_delta= 6
fee_base_msat= 1
fee_prop_millionths= 10
```

## eclair

* accept_channelで取得

```text
dust_limit_sat= 546
max_htlc_value_in_flight_msat= 100000000000
channel_reserve_sat= 400
min_depth= 2
htlc_minimum_msat= 1
to_self_delay= 144
max_accepted_htlcs= 30
```

```text
cltv_expiry_delta= 144
fee_base_msat= 10000
fee_prop_millionths= 100
```

## lnd

* accept_channelで取得(ptarmiganが800000satをfunding / `push_msat`は0)

```text
dust_limit_sat= 573
max_htlc_value_in_flight_msat= 792000000
channel_reserve_sat= 8000
min_depth= 3
htlc_minimum_msat= 1000
to_self_delay= 144
max_accepted_htlcs= 483
```

```text
cltv_expiry_delta= 144
fee_base_msat= 1000
fee_prop_millionths= 1
```

## ptarmigan

```text
dust_limit_sat= 546
max_htlc_value_in_flight_msat= 9223372036854775807
channel_reserve_sat= 700
min_depth= 1
htlc_minimum_msat= 0
feerate_per_kw= `estimatefee 6`を4分の1した値
to_self_delay= 40
max_accepted_htlcs= 6
```

```text
cltv_expiry_delta= 36
fee_base_msat= 10
fee_prop_millionths= 100
```

### table

|item |c-lightning |eclair |lnd |ptarmigan |
|-- |-- |-- |-- |-- |
|dust_limit_sat|546|546|573|546|
|max_htlc_value_in_flight_msat|18446744073709551615|100000000000|792000000|9223372036854775807|
|channel_reserve_sat|8000|400|8000|700|
|minimum_depth|1|2|3|1|
|htlc_minimum_msat|0|1|1000|0|
|to_self_delay|6|144|144|40|
|max_accepted_htlcs|483|30|483|6|
|cltv_expiry_delta|6|144|144|36|
|fee_base_msat|1|10000|1000|10|
|fee_prop_millionths|10|100|1|100|

# 回避方法

## lnd -- c-lightning

* feerateがあわない
  * [2018/05/07]現在、`dev-setfees`コマンドはデフォルトで使用できないようになった。
    * 使用したい場合は、 `make DEVELOPER=1` などとしてビルドし直すこと。
  * BOLT#2にopen_channel/accept_channelで受信側が接続を切る条件として、以下があるためと思われる。
    - `it considers feerate_per_kw too small for timely processing or unreasonably large.`
  * `bitcoind`と`btcd`でfeeのestimateに差があるためか？
  * ptarmiganでは、まだチェックする処理を入れていない
  * c-lightningに`./cli/lightning-cli dev-setfees`で設定できるので、immediateの値をlndと近くすると、とりあえず進められる
    - `./cli/lightning-cli dev-setfees xxx`